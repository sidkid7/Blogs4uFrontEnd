{"ast":null,"code":"import _defineProperty from\"C:/Users/patil/Desktop/Blog Application Project/Test/blog-app-main (2)/blog-app-main/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/patil/Desktop/Blog Application Project/Test/blog-app-main (2)/blog-app-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/patil/Desktop/Blog Application Project/Test/blog-app-main (2)/blog-app-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import{useEffect}from\"react\";import{Card,CardBody,Form,Input,Label,Button,Container}from\"reactstrap\";import{loadAllCategories}from\"../services/category-service\";import JoditEditor from\"jodit-react\";import{useRef}from\"react\";import{createPost as doCreatePost,updatePostById,uploadPostImage}from\"../services/post-service\";import{getCurrentUserDetail}from\"../auth\";import{toast}from\"react-toastify\";import{useSearchParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdatePost=function UpdatePost(){//to get postId from profile info\nvar _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,1),searchParams=_useSearchParams2[0];var postId=searchParams.get(\"postId\");//console.log(postId);\nvar editor=useRef(null);// const [content,setContent] =useState('')\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),categories=_useState2[0],setCategories=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var _useState7=useState({title:\"\",content:\"\",categoryId:\"\"}),_useState8=_slicedToArray(_useState7,2),post=_useState8[0],setPost=_useState8[1];// const config={\n//     placeholder:\"Start typing...\",\n// }\nuseEffect(function(){setUser(getCurrentUserDetail());loadAllCategories().then(function(data){console.log(data);setCategories(data);}).catch(function(error){console.log(error);});},[]);//field changed function\nvar fieldChanged=function fieldChanged(event){// console.log(event)\nsetPost(_objectSpread(_objectSpread({},post),{},_defineProperty({},event.target.name,event.target.value)));};//   file change uplad event\nvar handleFileChange=function handleFileChange(event){console.log(event.target.files[0]);setImage(event.target.files[0]);};var contentFieldChanaged=function contentFieldChanaged(data){setPost(_objectSpread(_objectSpread({},post),{},{content:data}));};//create post function\nvar createPost=function createPost(event){event.preventDefault();// console.log(post)\nif(post.title.trim()===\"\"){toast.error(\"post  title is required !!\");return;}if(post.content.trim()===\"\"){toast.error(\"post content is required !!\");return;}if(post.categoryId===\"\"){toast.error(\"select some category !!\");return;}//submit the form one server\n// post[\"postId\"] = user.id;\n// console.log(postId+\"Inside\");\npost[\"postId\"]=postId;updatePostById(post).then(function(data){uploadPostImage(image,data.postId).then(function(data){toast.success(\"Image uploaded.\");});//   .catch(error => {\n//     toast.error(\"Error in uploading\")\n//     console.log(error)\n//   })\ntoast.success(\"Post Created !!\");// console.log(post)\nsetPost({title:\"\",content:\"\",categoryId:\"\"});}).catch(function(error){toast.error(\"Post not created due to some error !!\");console.log(error);});};return/*#__PURE__*/_jsx(\"div\",{className:\"wrapper pt-5\",children:/*#__PURE__*/_jsx(Card,{className:\"shadow-sm  border-0 mt-2\",children:/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Update your post\"}),/*#__PURE__*/_jsxs(Form,{onSubmit:createPost,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",children:[/*#__PURE__*/_jsx(Label,{for:\"title\",children:\"Post title\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",id:\"title\",placeholder:\"Enter here\",className:\"rounded-0\",name:\"title\",onChange:fieldChanged})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",children:[/*#__PURE__*/_jsx(Label,{for:\"content\",children:\"Post Content\"}),/*#__PURE__*/_jsx(JoditEditor,{ref:editor,value:post.content,onChange:function onChange(newContent){return contentFieldChanaged(newContent);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsx(Label,{for:\"image\",children:\"Select Cover image\"}),/*#__PURE__*/_jsx(Input,{id:\"image\",name:\"image\",type:\"file\",onChange:handleFileChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",children:[/*#__PURE__*/_jsx(Label,{for:\"category\",children:\"Post Category\"}),/*#__PURE__*/_jsxs(Input,{type:\"select\",id:\"category\",placeholder:\"Enter here\",className:\"rounded-0\",name:\"categoryId\",onChange:fieldChanged,defaultValue:0,children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,value:0,children:\"--Select category--\"}),categories.map(function(category){return/*#__PURE__*/_jsx(\"option\",{value:category.categoryId,children:category.categoryTitle},category.categoryId);})]})]}),/*#__PURE__*/_jsxs(Container,{className:\"text-center\",children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",className:\"rounded-0\",color:\"success\",children:\"Update Post\"}),/*#__PURE__*/_jsx(Button,{type:\"reset\",className:\"rounded-0 ms-2\",color:\"secondary\",children:\"Reset Content\"})]})]})]})})});};export default UpdatePost;","map":{"version":3,"names":["useState","useEffect","Card","CardBody","Form","Input","Label","Button","Container","loadAllCategories","JoditEditor","useRef","createPost","doCreatePost","updatePostById","uploadPostImage","getCurrentUserDetail","toast","useSearchParams","UpdatePost","searchParams","postId","get","editor","categories","setCategories","undefined","user","setUser","image","setImage","title","content","categoryId","post","setPost","then","data","console","log","catch","error","fieldChanged","event","target","name","value","handleFileChange","files","contentFieldChanaged","preventDefault","trim","success","newContent","map","category","categoryTitle"],"sources":["C:/Users/patil/Desktop/Blog Application Project/Test/blog-app-main (2)/blog-app-main/src/components/UpdatePost.jsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport {\r\n  Card,\r\n  CardBody,\r\n  Form,\r\n  Input,\r\n  Label,\r\n  Button,\r\n  Container,\r\n} from \"reactstrap\";\r\nimport { loadAllCategories } from \"../services/category-service\";\r\nimport JoditEditor from \"jodit-react\";\r\nimport { useRef } from \"react\";\r\nimport { createPost as doCreatePost,updatePostById, uploadPostImage } from \"../services/post-service\";\r\nimport { getCurrentUserDetail } from \"../auth\";\r\nimport { toast } from \"react-toastify\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\nconst UpdatePost = () => {\r\n\r\n\r\n    //to get postId from profile info\r\n    const [searchParams] = useSearchParams();\r\n    const postId = searchParams.get(\"postId\");\r\n    //console.log(postId);\r\n\r\n  const editor = useRef(null);\r\n  // const [content,setContent] =useState('')\r\n  const [categories, setCategories] = useState([]);\r\n  const [user, setUser] = useState(undefined);\r\n  const [image,setImage] = useState(null);\r\n\r\n  const [post, setPost] = useState({\r\n    title: \"\",\r\n    content: \"\",\r\n    categoryId: \"\"\r\n  });\r\n\r\n  \r\n  // const config={\r\n  //     placeholder:\"Start typing...\",\r\n\r\n  // }\r\n\r\n \r\n\r\n  useEffect(() => {\r\n    setUser(getCurrentUserDetail());\r\n    loadAllCategories()\r\n      .then((data) => {\r\n        console.log(data);\r\n        setCategories(data);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }, []);\r\n\r\n  //field changed function\r\n  const fieldChanged = (event) => {\r\n    // console.log(event)\r\n    setPost({ ...post, [event.target.name]: event.target.value });\r\n  };\r\n\r\n   //   file change uplad event\r\n   const handleFileChange = (event) => {\r\n    console.log(event.target.files[0]);\r\n    setImage(event.target.files[0]);\r\n  };\r\n\r\n  const contentFieldChanaged = (data) => {\r\n    setPost({ ...post, content: data });\r\n  };\r\n\r\n  //create post function\r\n  const createPost = (event) => {\r\n    event.preventDefault();\r\n\r\n    // console.log(post)\r\n    if (post.title.trim() === \"\") {\r\n      toast.error(\"post  title is required !!\");\r\n      return;\r\n    }\r\n\r\n    if (post.content.trim() === \"\") {\r\n      toast.error(\"post content is required !!\");\r\n      return;\r\n    }\r\n\r\n    if (post.categoryId === \"\") {\r\n      toast.error(\"select some category !!\");\r\n      return;\r\n    }\r\n\r\n    //submit the form one server\r\n    // post[\"postId\"] = user.id;\r\n   // console.log(postId+\"Inside\");\r\n    post[\"postId\"] = postId;\r\n    updatePostById(post)\r\n      .then((data) => {\r\n        uploadPostImage(image, data.postId)\r\n          .then(data => {\r\n            toast.success(\"Image uploaded.\")\r\n          })\r\n        //   .catch(error => {\r\n        //     toast.error(\"Error in uploading\")\r\n        //     console.log(error)\r\n        //   })\r\n        toast.success(\"Post Created !!\");\r\n        // console.log(post)\r\n\r\n        setPost({\r\n          title: \"\",\r\n          content: \"\",\r\n          categoryId: \"\",\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        toast.error(\"Post not created due to some error !!\");\r\n        console.log(error)\r\n      });\r\n  };\r\n\r\n  \r\n\r\n  return (\r\n    <div className=\"wrapper pt-5\">\r\n      <Card className=\"shadow-sm  border-0 mt-2\">\r\n        <CardBody>\r\n          {/* {JSON.stringify(post)} */}\r\n          <h3>Update your post</h3>\r\n          <Form onSubmit={createPost}>\r\n            <div className=\"my-3\">\r\n              <Label for=\"title\">Post title</Label>\r\n              <Input\r\n                type=\"text\"\r\n                id=\"title\"\r\n                placeholder=\"Enter here\"\r\n                className=\"rounded-0\"\r\n                name=\"title\"\r\n                onChange={fieldChanged}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"my-3\">\r\n              <Label for=\"content\">Post Content</Label>\r\n              {/* <Input\r\n                                type=\"textarea\"\r\n                                id=\"content\"\r\n                                placeholder=\"Enter here\"\r\n                                className=\"rounded-0\"\r\n                                style={{ height: '300px' }}\r\n                            /> */}\r\n\r\n              <JoditEditor\r\n                ref={editor}\r\n                value={post.content}\r\n                onChange={(newContent) => contentFieldChanaged(newContent)}\r\n              />\r\n            </div>\r\n            {/* file filed */}\r\n            <div className=\"mt-3\">\r\n              <Label for=\"image\">Select Cover image</Label>\r\n              <Input id=\"image\" name=\"image\" type=\"file\" onChange={handleFileChange} />\r\n            </div>\r\n\r\n            <div className=\"my-3\">\r\n              <Label for=\"category\">Post Category</Label>\r\n              <Input\r\n                type=\"select\"\r\n                id=\"category\"\r\n                placeholder=\"Enter here\"\r\n                className=\"rounded-0\"\r\n                name=\"categoryId\"\r\n                onChange={fieldChanged}\r\n                defaultValue={0}\r\n              >\r\n                <option disabled value={0}>\r\n                  --Select category--\r\n                </option>\r\n\r\n                {categories.map((category) => (\r\n                  <option value={category.categoryId} key={category.categoryId}>\r\n                    {category.categoryTitle}\r\n                  </option>\r\n                ))}\r\n              </Input>\r\n            </div>\r\n\r\n            <Container className=\"text-center\">\r\n              <Button type=\"submit\" className=\"rounded-0\" color=\"success\">\r\n                Update Post\r\n              </Button>\r\n              <Button type=\"reset\" className=\"rounded-0 ms-2\" color=\"secondary\" >\r\n                Reset Content\r\n                \r\n              </Button>\r\n            </Container>\r\n          </Form>\r\n        </CardBody>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UpdatePost;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}